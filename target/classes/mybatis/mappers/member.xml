<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.member">
	<resultMap type="MemberDTO" id="memberResult">
		<result property="mem_seq.nextval" column="id" />
		<result property="member_id" column="member_id" />
		<result property="member_password" column="member_password" />
		<result property="member_phone" column="member_phone"/>
		<result property="member_phone1" column="member_phone"/>
		<result property="member_phone2" column="member_phone"/>
		<result property="member_name" column="member_name" />
		<result property="member_email" column="member_email" />
		<result property="member_joinDate" column="member_joinDate" />
		<result property="zipno" column="zipno" />
		<result property="roadFullAddr" column="roadFullAddr" />
		<result property="addDetail" column="addDetail" />
	</resultMap> 
	<resultMap type="memberBean" id="memResult">
		<result property="id" column="id"/>
		<result property="password" column="password" />
		<result property="name" column="name" />
		<result property="phone" column="phone" />
		<result property="mail" column="mail" />
		<result property="address" column="address" />
		<result property="reg" column="reg" />
	</resultMap>


	
	<!-- 회원가입 -->
	<insert id="insertMember" parameterType="MemberDTO">
		<![CDATA[
		INSERT INTO member
		VALUES(mem_seq.nextval, #{member_id}, #{member_password},#{member_name},#{member_phone}||'-'||#{member_phone1}||'-'||#{member_phone2},  #{member_email},sysdate)
		]]>
	</insert>
	<!-- 회원가입 주소 -->
	<insert id="insertaddress" parameterType="MemberDTO">
		<![CDATA[
		INSERT INTO address
		VALUES(#{member_id}, #{zipno},#{roadFullAddr},#{addDetail})
		]]>
	</insert>
    
    <!-- 아이디 중복 체크 -->
    <select id="idcheck" resultType="int">
      SELECT COUNT(*) FROM member WHERE member_id = #{member_id}
    </select>
    
    <!-- 전화번호 중복 체크 -->
    <select id="phonecheck" resultType="int">
      SELECT COUNT(*) FROM member WHERE member_phone = #{member_phone}
    </select>
    
    <!-- email 중복 체크 -->
    <select id="emailcheck" resultType="int">
      SELECT COUNT(*) FROM member WHERE member_email = #{member_email}
    </select>
	
	<!-- id="loginById" 로 아이디/패스워드를 입력 받아서 MemberDTO를 반환하는 sql 작성 -->
	<select id="loginById"	parameterType="MemberDTO" resultType="MemberDTO">
		select * from member where member_id=#{member_id} <!-- and member_password=#{member_password} -->
	</select>

</mapper>
